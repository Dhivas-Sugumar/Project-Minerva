<!--<p style="color: green"><%#= notice %></p>-->
<%= javascript_include_tag 'review' %>
<%= render "shared_views/header_main" %>

<%= render @course %>
<% if user_signed_in? %>
  <% if @course.user_id == current_user.id %>

    <div class="row">
    <span class="col-sm-offset-10 col-sm-1 float-right">
    <%= link_to "Edit Course", edit_course_path(@course) ,class:"btn btn-outline-primary"%>
</span>
      <span class="col-sm-1 float-right">
        <% if @course.has_enroll? %>
          <p1>Can not delete since the course has users enrolled. </p1>
        <%else %>
    <%= button_to "Destroy Course", @course, method: :delete , class:"btn btn-outline-danger"%>
          <%end  %>
</span>
    </div>

  <% end %>
<%end %>

<div id="sections" class="text-center mb-5" >

  <a href= "<%=category_url(@course.category_id) %>">
    <h6 class="mb-4">Category: <%=Category.find(@course.category_id).category%></h6>
  </a>

  <div class="mt-4 mb-4">
    <% if user_signed_in? %>
      <%if @course.enrolled?(current_user) %>
        <% @id = @enrolls.where(user_id: current_user.id, course_id: @course.id).ids %>
        <td><%= button_to "Unenroll",enroll_path(@id), method: :delete ,class:"btn btn-outline-danger"%></td>

      <%else %>
        <td ><%= button_to 'Enroll in Course' , {:controller => 'enrolls', :enroll => {:action => 'create', :user_id => current_user.id, :course_id => @course.id, :completed => false}}, {:method => :post} %></td>


<%end %>
      <%else %>
      <%= link_to 'Sign In To Enroll', new_user_session_path, class: "btn btn-primary" %>
    <%end %>

    <h1>Sections</h1>


  </div>
  <% @sections.each do |section| %>
  <%= render partial: "sections/section_card" , locals: {section: section}  %>
  <% end %>
</div>

<%unless @course.draft? %>
<%= render partial:"reviews/reviews_course_show" %>
<%end %>


<%=render "shared_views/footer" %>

